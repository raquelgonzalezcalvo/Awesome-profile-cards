"use strict";const designLegend=document.querySelector(".js-design-legend"),fillLegend=document.querySelector(".js-fill-legend"),shareLegend=document.querySelector(".js-share-legend"),designForm=document.querySelector(".js-design-form"),fillForm=document.querySelector(".js-fill-form"),shareForm=document.querySelector(".js-share-form"),shareArrow=document.querySelector(".js-share-arrow"),fillArrow=document.querySelector(".js-fill-arrow"),designArrow=document.querySelector(".js-design-arrow"),buttonPalette1=document.querySelector(".js-buttonpalette1"),buttonPalette2=document.querySelector(".js-buttonpalette2"),buttonPalette3=document.querySelector(".js-buttonpalette3"),previewDiv=document.querySelector(".js-preview-div"),previewList=document.querySelector(".js-list");let data={palette:1,name:"",job:"",phone:"",email:"",linkedin:"",github:"",photo:""};const inputs=[{palette:"",name:"",job:"",phone:"",email:"",linkedin:"",github:"",photo:""}],allInputsList=document.querySelectorAll(".js-input"),buttonReset=document.querySelector(".js-reset"),previewName=document.querySelector(".js-name"),previewJob=document.querySelector(".js-preview-job"),previewMail=document.querySelector(".js-icon-e-mail"),previewPhone=document.querySelector(".js-icon-mobile"),previewLinkedin=document.querySelector(".js-icon-linkedin"),previewGithub=document.querySelector(".js-icon-github");let errorMsg=document.querySelectorAll(".js-error");const sendBtn=document.querySelector(".js-create-btn"),twitterBtn=document.querySelector(".js-twitter-btn"),linkCard=document.querySelector(".js-create-link"),inputName=document.querySelector(".js-name-input"),inputJob=document.querySelector(".js-job-input"),inputPhone=document.querySelector(".js-phone-input"),inputEmail=document.querySelector(".js-email-input"),inputLinkedin=document.querySelector(".js-linkedin-input"),inputGithub=document.querySelector(".js-github-input"),inputPhoto=document.querySelector(".js-photo-input"),twitterSection=document.querySelector(".js-twitterSection");function closeAllSections(){designForm.classList.add("collapsed"),fillForm.classList.add("collapsed"),shareForm.classList.add("collapsed")}function turnDownAllArrows(){designArrow.classList.add("arrow-collapsed"),fillArrow.classList.add("arrow-collapsed"),shareArrow.classList.add("arrow-collapsed")}function openAndTurnDesignSection(){designForm.classList.remove("collapsed"),designArrow.classList.remove("arrow-collapsed")}function handleClickDesign(e){closeAllSections(),turnDownAllArrows(),openAndTurnDesignSection()}function openAndTurnFillSection(){fillForm.classList.remove("collapsed"),fillArrow.classList.remove("arrow-collapsed")}function handleClickFill(e){closeAllSections(),turnDownAllArrows(),openAndTurnFillSection()}function openAndTurnShareSection(){shareForm.classList.remove("collapsed"),shareArrow.classList.remove("arrow-collapsed")}function handleClickShare(e){closeAllSections(),turnDownAllArrows(),openAndTurnShareSection()}designLegend.addEventListener("click",handleClickDesign),fillLegend.addEventListener("click",handleClickFill),shareLegend.addEventListener("click",handleClickShare);const localStorageData=JSON.parse(localStorage.getItem("formData"));function updatePreview(){""===data.name?previewName.innerHTML="Nombre y Apellidos":previewName.innerHTML=data.name,""===data.job?previewJob.innerHTML="Front-end developer":previewJob.innerHTML=data.job,previewMail.href="mailto:"+data.email,previewPhone.href="tel:"+data.phone,previewLinkedin.href="https://linkedin.com/in/"+data.linkedin,previewGithub.href="https://github.com/"+data.github}console.log(data),localStorageData&&(data=localStorageData,updatePreview(),inputName.value=data.name,inputJob.value=data.job,inputEmail.value=data.email,inputPhone.value=data.phone,inputLinkedin.value=data.linkedin,inputGithub.value=data.github);const handleClickReset=()=>{data.palette=1,data.name="",data.job="",data.phone="",data.email="",data.linkedin="",data.github="",data.photo="",resetImage(),localStorage.removeItem("formData");for(let e=0;e<allInputsList.length;e++)allInputsList[e].value=""};function resetImage(){profilePreview.style.backgroundImage='url("./assets/images/test.png")',profileImage.style.backgroundImage="none",updatePreview()}function handleClickPalettes(e){const t=parseInt(e.target.id);console.log(t),console.log(e.target.id),data.palette=t,previewDiv.classList.remove("palette2"),previewDiv.classList.remove("palette3"),previewDiv.classList.add("palette"+t),previewList.classList.remove("palette2"),previewList.classList.remove("palette3"),previewList.classList.add("palette"+t)}function showErrorMsg(e){for(let t=0;t<errorMsg.length;t++)errorMsg[t].attributes.error.value===e.id&&(errorMsg[t].innerHTML="",errorMsg[t].innerHTML='<i class="fa-solid fa-circle-exclamation"></i> Introduce tu '+errorMsg[t].id)}function addClassError(e){for(let t=0;t<allInputsList.length;t++)allInputsList[t].id===e.id&&(allInputsList[t].classList.add("js-border-input"),allInputsList[4].classList.remove("js-border-input"))}function handleInputForm(e){data[e.target.name]=e.target.value,updatePreview(),e.target.value?(hideShowErrorMsg(e.target),removeClassError(e.target)):(showErrorMsg(e.target),addClassError(e.target)),localStorage.setItem("formData",JSON.stringify(data))}function hideShowErrorMsg(e){for(let t=0;t<errorMsg.length;t++)errorMsg[t].attributes.error.value===e.id&&(errorMsg[t].innerHTML="")}function removeClassError(e){for(let t=0;t<allInputsList.length;t++)allInputsList[t].id===e.id&&allInputsList[t].classList.remove("js-border-input")}buttonReset.addEventListener("click",handleClickReset),buttonPalette1.addEventListener("click",handleClickPalettes),buttonPalette2.addEventListener("click",handleClickPalettes),buttonPalette3.addEventListener("click",handleClickPalettes);for(let e=0;e<allInputsList.length;e++)allInputsList[e].addEventListener("input",handleInputForm);const fr=new FileReader,fileField=document.querySelector(".js__profile-upload-btn"),profileImage=document.querySelector(".js__profile-image"),profilePreview=document.querySelector(".js__profile-preview");function getImage(e){const t=e.currentTarget.files[0];fr.addEventListener("load",writeImage),fr.readAsDataURL(t)}function writeImage(){profileImage.style.backgroundImage=`url(${fr.result})`,profilePreview.style.backgroundImage=`url(${fr.result})`,data.photo=fr.result,console.log(data)}function handleClickSend(e){e.preventDefault(),fetch("https://dev.adalab.es/api/card/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(data)}).then(e=>e.json()).then(e=>{const t=document.querySelector(".js-dataError"),r=document.querySelector(".js-share-twitter"),n=document.querySelector(".js-twitter-section");e.success?(t.classList.add("display--none"),n.classList.remove("display--none"),linkCard.innerHTML=e.cardURL,linkCard.href=e.cardURL,r.href="https://twitter.com/intent/tweet?text=Mi%20tarjeta%20de%20presentaci%C3%B3n&url="+e.cardURL):e.error.includes("Database error")?(t.innerHTML="<p class='text-error'>Por favor, sube una imagen menor a 200x200px y 120kb</p>",n.classList.add("display--none")):(t.innerHTML="<p class='text-error'>¡Algo estás haciendo mal! Por favor inténtalo de nuevo.</p>",n.classList.add("display--none"))})}fileField.addEventListener("change",getImage),sendBtn.addEventListener("click",handleClickSend);